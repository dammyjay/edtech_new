<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8" />
    <title>Feedbacks</title>
    <link rel="icon" type="image/x-icon" href="/logo.png" />
    <script src="https://cdn.ckeditor.com/4.22.1/standard/ckeditor.js"></script>
    <link rel="stylesheet" href="/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css"
      integrity="sha512-..."
      crossorigin="anonymous"
      referrerpolicy="no-referrer"
    />
    <!-- Open Graph Meta Tags -->
    <meta property="og:title" content="Share Your Feedback â€“ JKT Acad Elearn Platform" />
    <meta property="og:description" content="Your voice matters! Share your experience, testimony, suggestions, or complaints to help us build a better learning community." />
    <meta property="og:image" content="https://acad.jkthub.com/images/JKT logo.pngg" />
    <meta property="og:url" content="https://acad.jkthub.com/feedback" />
    <meta property="og:type" content="website" />

    <!-- Twitter Card -->
    <meta name="twitter:card" content="summary_large_image" />
    <meta name="twitter:title" content="Share Your Feedback â€“ JKT Acad Elearn Platform" />
    <meta name="twitter:description" content="Your feedback helps us grow. Share your experience easily." />
    <meta name="twitter:image" content="https://acad.jkthub.com/images/JKT logo.png" />

    <style>
      .section {
  width: 85%;
  max-width: 650px;
  margin: 40px auto;
  padding: 25px;
  background: #ffffff;
  border-radius: 14px;
  box-shadow: 0 5px 20px rgba(0,0,0,0.1);
}

.section h2 {
  text-align: center;
  margin-bottom: 25px;
  color: #222;
}

/* Inputs & selects */
.section input,
.section select,
.section textarea {
  width: 100%;
  padding: 12px 14px;
  margin-bottom: 15px;
  border: 1px solid #ccc;
  border-radius: 10px;
  font-size: 16px;
  transition: all 0.25s ease;
}

.section input:focus,
.section select:focus,
.section textarea:focus {
  border-color: #009688;
  box-shadow: 0 0 5px rgba(0,150,136,0.3);
  outline: none;
}

.section textarea {
  min-height: 120px;
  resize: vertical;
}

/* Button */
.section button[type='submit'] {
  width: 100%;
  padding: 12px;
  background: #009688;
  border: none;
  border-radius: 10px;
  color: white;
  font-size: 18px;
  cursor: pointer;
  transition: 0.25s;
}

.section button[type='submit']:hover {
  background: #00796b;
}

/* Popup */
#successPopup {
  border-radius: 16px !important;
  padding: 30px !important;
}

#successPopup h3 {
  font-size: 22px;
  font-weight: 600;
}

.feedback-intro {
  text-align: center;
  font-size: 17px;
  line-height: 1.6;
  color: #444;
  margin-bottom: 25px;
  background: #f7fdfd;
  padding: 15px 20px;
  border-radius: 12px;
  border-left: 4px solid #009688;
  box-shadow: 0 3px 12px rgba(0,0,0,0.05);
}


    </style>
  </head>
<body>
     <%- include('./partials/userHeader', { title: 'Feedback' }) %>

    <!-- <section class="section">
      <h2>Share Your Feedback</h2>

        <form id="feedbackForm">
        <label>Who are you?</label>
        <select id="userType" name="user_type" required onchange="showFields()">
          <option value="">-- Select user type --</option>
          <option value="parent">Parent</option>
          <option value="student">Student</option>
          <option value="teacher">Teacher</option>
          <option value="school_owner">School Owner</option>
          <option value="organization">Organization</option>
        </select>
        <br><br>

        <label>Feedback Category</label>
        <select name="category">
          <option value="">-- Select Category --</option>
          <option value="general">General</option>
          <option value="complaint">Complaint</option>
          <option value="suggestion">Suggestion</option>
          <option value="testimony">Testimony</option>
        </select>
        <br><br>


        <input type="text" name="name" placeholder="Your Name" required><br><br>
        <input type="email" name="email" placeholder="Email (optional)"><br><br>

        <div id="dynamic-fields"></div>

        <label>Rate Your Experience</label>
        <select name="rating" required>
          <option value="">-- Rating --</option>
          <option value="1">1 - Poor</option>
          <option value="2">2 - Fair</option>
          <option value="3">3 - Good</option>
          <option value="4">4 - Very Good</option>
          <option value="5">5 - Excellent</option>
        </select>
        <br><br>

        <textarea name="message" placeholder="Your feedback... you can also state the duration you've partnered or joined us" required></textarea><br><br>

        <input type="hidden" id="extraData" name="extra">

        <button type="submit">Submit Feedback</button>
      </form>

    </section> -->


    <section class="section">
  <h2>Share Your Feedback</h2>
  <p class="feedback-intro">
      Your voice matters to us. ðŸ’›  
      Whether you're a parent, student, teacher, school owner, or partner organization,  
      your experience helps us grow, improve, and serve you better.  
      Please take a moment to share your thoughts â€” we value every feedback,  
      every testimony, and every suggestion you give.  
      Together, we are building a stronger learning community. ðŸŒ±âœ¨
    </p>

  <form id="feedbackForm">
    <label>Which best describe you?</label>
    <select id="userType" name="user_type" required onchange="showFields()">
      <option value="">-- Select user type --</option>
      <option value="parent">Parent</option>
      <option value="student">Student</option>
      <option value="teacher">Teacher</option>
      <option value="school_owner">School Owner / Admin</option>
      <option value="organization">Organization</option>
    </select>

    <label>Feedback Category</label>
    <select name="category">
      <option value="">-- Select Category --</option>
      <option value="general">General</option>
      <option value="complaint">Complaint</option>
      <option value="suggestion">Suggestion</option>
      <option value="testimony">Testimony</option>
    </select>

    <input type="text" name="name" placeholder="Your Name" required>
    <input type="email" name="email" placeholder="Email (optional)">

    <div id="dynamic-fields"></div>

    <label>Rate Your Experience</label>
    <select name="rating" required>
      <option value="">-- Rating --</option>
      <option value="1">1 - Poor</option>
      <option value="2">2 - Fair</option>
      <option value="3">3 - Good</option>
      <option value="4">4 - Very Good</option>
      <option value="5">5 - Excellent</option>
    </select>

    <textarea name="message" placeholder="Your feedback..." required></textarea>

    <input type="hidden" id="extraData" name="extra">

    <button type="submit">Submit Feedback</button>
  </form>
</section>


  <div id="successPopup" style="
    display:none;
    position: fixed;
    top: 50%;
    left: 50%;
    transform: translate(-50%, -50%);
    background: white;
    padding: 20px 25px;
    border-radius: 10px;
    text-align: center;
    width: 320px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.2);
    z-index: 9999;
  ">
    <h3 style="margin-bottom:10px; color:green;">Thank You!</h3>
    <p id="popupMessage">Your feedback was submitted.</p>
    <button onclick="closePopup()" style="
      margin-top:15px;
      padding:8px 20px;
      border:none;
      background:green;
      color:white;
      border-radius:5px;
      cursor:pointer;
    ">OK</button>
  </div>

  <div id="popupOverlay" style="
    display:none;
    position:fixed;
    inset:0;
    background:rgba(0,0,0,0.5);
    z-index:9998;
  "></div>


<script>
  function showFields() {
    const type = document.getElementById("userType").value;
    let html = "";

    if (type === "parent") {
      html = `
        <input type="text" name="student_class" placeholder="Childâ€™s Class (optional)">
      `;
    }

    if (type === "teacher") {
      html = `
        <input type="text" name="school_name" placeholder="School Name" required>
        <input type="text" name="student_class" placeholder="Classes You Teach">
      `;
    }

    if (type === "school_owner") {
      html = `
        <input type="text" name="school_name" placeholder="School Name" required>
      `;
    }

    if (type === "student") {
      html = `
        <input type="text" name="student_class" placeholder="Your Class">
      `;
    }

    if (type === "organization") {
      html = `
        <input type="text" name="organization_name" placeholder="Organization Name" required>
      `;
    }

    document.getElementById("dynamic-fields").innerHTML = html;
  }
</script>

<div id="thankYouMessage" style="display:none; color:green; font-weight:bold; margin-top:10px;"></div>

<script>
document.getElementById("feedbackForm").addEventListener("submit", async function(e) {
  e.preventDefault();

  const formData = new FormData(this);
  const data = Object.fromEntries(formData.entries());

  try {
    const response = await fetch("/feedback", {
      method: "POST",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    });

    // const result = await response.json();

    // if(result.success){
    //   this.reset();
    //   const thankYou = document.getElementById("thankYouMessage");
    //   thankYou.textContent = result.message;
    //   thankYou.style.display = "block";
    // } else {
    //   alert(result.message || "Error submitting feedback");
    // }

     const result = await response.json();

    if (result.success) {
      document.getElementById("popupMessage").innerText = result.message;
      showPopup();
      this.reset(); // clear form
    } else {
      alert("Something went wrong.");
    }

    
    
  } catch(err) {
    console.error(err);
    alert("Could not submit feedback");
  }
});


function showPopup() {
  document.getElementById("popupOverlay").style.display = "block";
  document.getElementById("successPopup").style.display = "block";
}

function closePopup() {
  document.getElementById("popupOverlay").style.display = "none";
  document.getElementById("successPopup").style.display = "none";
}
</script>

   <%- include('./partials/userFooter') %>
    
</body>
</html>